{% extends "pollster/base_admin.html" %}
{% block extrahead %}
<style>
.survey-list td {
	padding: .4em;
	vertical-align: middle;
}

.survey-list .status-DRAFT td {
	color: darkgrey;
}

.survey-list .status-PUBLISHED td {
	color: #5cb85c;
}

.status-PUBLISHED .status {
	background-color:#5cb85c;
	color: white;
	
}

.status-UNPUBLISHED .status {
	color: white;
	background-color: darkgrey;
}

.survey-list .status-UNPUBLISHED td {
	color: grey;
}

.status {
	font-size: .8em;
	font-weight: bold;
	padding: .4em;
	border-radius: .4em;
}

.status-UNPUBLISHED td.title {
	font-style: italic;
	text-decoration:line-through;	
}

 .action {
	border: 1px solid steelblue;
	border-radius: .3em;
	background-color: white;
	padding: .3em;
	font-weight: bold;
	text-decoration: none;
	margin: 0;
	color: steelblue;
}

.publish {
	background-color: #5cb85c;
	color:white;
	border: 1px solid #5cb85c;
}

.unpublish {
	background-color: #d9534f;
	color:white;
	border: 1px solid #d9534f;
}

.survey-list form {
	margin:0;
}
.action:hover {
	background-color: steelblue;
	color: white;
}
.action-list li {
	padding-top: 1em;
	list-style-type:none;
}

</style>
{% endblock %}
{% block content %}
<div id="wok-main-panel-content">
    <div id="survey-list">
        <h1>Surveys</h1>
        <table class="survey-list">
	        {% for survey in surveys %}
            <tr class="status-{{survey.status}}">
                <td>#{{survey.id}}</td>
				<td class="title">{% if survey.title %}
                {{ survey.title }}
                {% else %}
                No Name
                {% endif %}
	            </td>	
				<td>{{survey.shortname }}</td>
				<td><span class="status">{{survey.status}}</span></td>
				<td><a class="action" href="{% url pollster_survey_test survey.id %}">test</a></td>
	            <td><a class="action"  href="{% url pollster_survey_edit survey.id %}">edit</a></td>
	            <td><a class="action"  href="{% url pollster_survey_translation_list survey.id %}">translate</a></td>
	            <td><a class="action"  href="{% url pollster_survey_chart_list survey.id %}">charts</a></td>
	            <td><a class="action"  href="{% url pollster_survey_export_xml survey.id %}">export</a></td>
	            <td>
				{% if survey.is_draft %}
	               <form action="{% url pollster_survey_publish survey.id %}" method="POST">{% csrf_token %}<button class="action publish">publish</button></form>
	            {% endif %}
				</td>
				<td>
				{% if survey.is_unpublished %}
                   <form action="{% url pollster_survey_publish survey.id %}" method="POST">{% csrf_token %}<button class="action re-publish">re-publish</button></form>
				{% endif %}
	           </td>
			    {% if survey.is_published %}
				<td>
					<form action="{% url pollster_survey_unpublish survey.id %}" method="POST">{% csrf_token %}<button class="action unpublish">unpublish</button></form>
	            </td>
				<td>
				    <a class="action"  href="{% url pollster_survey_results_csv survey.id %}">results</a>
	            </td>
				<td>
					{{ survey.count_responses }}
	            {% else %}
				<td colspan="3">
				{% endif %}
				</td>
			</tr>				
            {% endfor %}
			</table>
        <ul class="action-list">
            <li>
            <form action="{% url pollster_survey_import %}" enctype="multipart/form-data" method="POST">
                {% csrf_token %}
                {{ form_import.data }}
                <button class="action">import survey</button>
            </form>
            </li>
            <li>
            <form action="{% url pollster_survey_add %}" method="GET">
                <button class="action">new survey</button>
            </form>
            </li>
        </ul>
    </div>
</div>
{% endblock %}
